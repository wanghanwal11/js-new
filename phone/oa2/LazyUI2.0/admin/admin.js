!function(){function f(b){var c=[{url:a.dir+"/admin/jsSDK.js",type:"POST",cache:!0,data:{url:"../admin/jsSDK.js",type:"POST",filetype:"js"},success:function(a){h(a)}}],d="",e="";a.browserType==a.androidName?(d=a.dir+"/admin/androidSDK.js",e="androidSDK.js",c.push({url:d,type:"POST",cache:!0,data:{url:"../admin/androidSDK.js",type:"POST",filetype:"js"},success:function(a){h(a)}})):a.browserType==a.iosName&&(d=a.dir+"/admin/iosSDK.js",e="iosSDK.js",c.push({url:d,type:"POST",cache:!0,data:{url:"../admin/iosSDK.js",type:"POST",filetype:"js"},success:function(a){h(a)}})),c.push({url:a.dir+"/admin/"+a.theme,type:"POST",cache:!0,data:{url:"../admin/"+a.theme,type:"POST",filetype:"css"},success:function(a){i(a)}}),n(c,function(){b()})}function g(){o("cache_ajax",null)}function h(a){try{new Function(a)()}catch(b){v(b),g()}}function i(a){var b=document.getElementsByTagName("head")[0],c=document.createElement("style");c.innerHTML=a,b.appendChild(c)}function j(){var f,b=!1,c=document.documentElement,d=a.UI,e=navigator.userAgent.toLowerCase();-1!=e.indexOf(a.androidName)?a.browserType=a.androidName:-1!=e.indexOf(a.iosName)?a.browserType=a.iosName:"micromessenger"==e.match(/MicroMessenger/i)?a.browserType="weixin":e.match(/(iPhone|iPad|iPod|iOS)/i)?a.browserType="ios":e.match(/android/i)?a.browserType="android":(a.browserType="pc",b=!0),b&&d.pc||(f=c.clientWidth,"v"!=d.screen&&(f=c.clientHeight),a.fontSize=(d.fontSize||30)*(f/(d.width||720)),c.style.fontSize=a.fontSize+"px")}function k(a,b){var c,d;if("array"==l(a))for(c=0;c<a.length;c++)b(a[c],c);else for(d in a)b(a[d],d)}function l(a){var b=Object.prototype.toString;switch(b.call(a)){case"[object HTMLDivElement]":return"element";case"[object String]":return"string";case"[object Object]":return"object";case"[object Array]":return"array";case"[object Function]":return"function";case"[object Number]":return"number";case"[object Boolean]":return"boolean";default:return null}}function m(a){var b=a.split("?"),c=b[0].split("#")[1],d=b[1]?b[1].split("&"):[],e={};return k(d,function(a){var c=a.split("=");e[c[0]]=c[1]}),{path:c,response:e}}function n(a,b){function d(){q({url:a[c].url,type:a[c].type||"GET",cache:a[c].cache||"false",data:a[c].data||{},success:function(e){a[c].success&&a[c].success(e),c<a.length-1?(c++,d()):b&&b()},error:function(e){a[c].error&&a[c].error(e),c<a.length-1?(c++,d()):b&&b()}})}var c=0;a&&a.length>0&&d()}function o(a,b){localStorage.setItem(a,JSON.stringify(b))}function p(a,b){if(localStorage.getItem(a)){var c=localStorage.getItem(a);return b&&b(c),JSON.parse(c)}return b&&b(null),null}function q(a){function c(){var a,c,d,e;"jsonp"==b.dataType?(a=getAutoIdFun(),window[a]=function(a){back1&&back1(a)},c=-1==b.url.indexOf("?")?"?":"&",B({path:b.url+c+"jsoncallback="+a,onload:function(){},onerror:function(){v(b.url+c+"jsoncallback="+a+"不存在!")}})):(d=new XMLHttpRequest,"POST"==b.type?(e=b.url.replace(/.*?\?/,""),b.url.replace(/\?.*/,""),d.open("POST",b.url,!0),d.setRequestHeader("Content-type","application/x-www-form-urlencoded"),d.send(e)):(d.open("GET",b.url,!0),d.send()),d.onreadystatechange=function(){4==d.readyState&&200==d.status?b.success(d.responseText):(0==d.status||(d.status+"").match(/(4|5)\d\d/))&&b.error("ajax来自："+b.url+";status:"+d.status+"text:"+d.responseText)})}var b={data:a.data||{},cache:a.cache||"",url:a.url||"",type:a.type||"GET",dataType:a.dataType||"",error:a.error||function(){},success:a.success||function(){}};b.cache===!0?(t(b.data.url,function(a){b.success(a)},function(){c()}),d.postMessage({type:"ajaxList",data:b.data})):c()}function s(a){var b=a.data;("css"==b.filetype||"js"==b.filetype)&&u(b.url,a.message)}function t(a,b,c){var d=p("cache_ajax");d&&null!=d[a]&&"null"!=d[a]&&"null"!=d[a]&&"undefined"!=d[a]&&void 0!=d[a]?b(d[a]):c&&c()}function u(a,b){var c=p("cache_ajax");c||(c={}),c[a]=b,o("cache_ajax",c)}function v(a){console.log(a)}function w(a){console.log("来自worker:"+JSON.stringify(a))}function x(a){console.log("来自计算worker:"+JSON.stringify(a))}function y(a,b,c){var e,d=document.createElement(a);if(b&&(-1!=b.indexOf("#")?d.id=b.replace("#",""):d.className=b.replace(".","")),"a"==a&&d.setAttribute("href","javascript:;"),c)for(e in c)d.setAttribute(e,c[e]);return d}function z(b,c,d){function f(){q({url:a.dir+"/plugins/"+b.type+"/"+b.type+".js",type:"POST",cache:!0,data:{url:"../plugins/"+b.type+"/"+b.type+".js",type:"POST",filetype:"js"},success:function(a){h(a),g()},error:function(a){v(a)}})}function g(){var a=document.getElementById(e),f=lazy.create("div","#"+e,{type:b["type"]});b.style&&!function(){for(var a in b.style)f.style[a]=b.style[a]}(),b.class&&(f.className=b.class),b.visible===!1?f.style.display="none":b.visible===!0&&(f.style.display="block"),a?(a.parentNode.insertBefore(f,a),a.parentNode.removeChild(a),lazy.plugins[b.type].init(f,b,a.parentNode),c(f)):(d&&d.appendChild(f),lazy.plugins[b.type].init(f,b,d),c(f))}if(b=A(b),b.type){var e=b.id||lazy.getAutoId();lazy.pluginsId[e]=b,lazy.plugins[b.type]?g():q({url:a.dir+"/plugins/"+b.type+"/"+b.type+".css",type:"POST",cache:!0,data:{url:"../plugins/"+b.type+"/"+b.type+".css",type:"POST",filetype:"css"},success:function(a){i(a),f()},error:function(a){v(a),f()}})}else v("setData:type参数不存在!")}function A(a){var b={};return lazy.for(a,function(a,c){var d,e;"function"==typeof a||"class"==c||"id"==c||"type"==c?b[c]=a:(d=c+"_lazy",e=c+"_change",b[d]=a,b.__defineGetter__(c,function(){return this[d]}),b.__defineSetter__(c,function(a){this[d]=a,this[e]&&this[e](a),this["all_change"]&&this["all_change"](a,c)}))}),b}function B(a){var c,b=document.createElement("script");a.id&&(b.id=a.id),a.class&&(b.className=a.class),c=document.getElementsByTagName("head")[0],b.src=a.path,c.appendChild(b),b.onload=function(){a.onload&&a.onload()},b.onerror=function(){v(a.path+"不存在!"),a.onerror&&a.onerror()}}function C(a){var b=document.getElementsByTagName("head")[0],c=document.createElement("link");c.rel="stylesheet",c.href=a.path,b.appendChild(c)}var c,d,e,a={dir:"LazyUI2.0",iosName:"vitoios",androidName:"vitoandroid",firstPage:"index",winName:"index",map:{},browserType:"pc",UI:{width:720,screen:"v",pc:!1,fontSize:30},autoId:0,theme:"admin.css",debug:!1,scrollList:{}},b=function(){this.name="LazyUI2.0",this.dir=a.dir,this.thisLoad=!1,this.autoId=0,this.pluginsId=[],this.plugins=[],this.touchObj={},this.fontSize=a.fontSize};b.prototype={init:function(a){f(function(){a(),window.addEventListener("scroll",function(){var a=router.bounceList[router.thisPage.path]||{},b=a.up||function(){},c=a.center||function(){},d=a.down||function(){},e=document.body.scrollHeight,f=document.body.scrollTop,g=document.body.clientHeight;e==f+g&&0!=f&&b(e,f,document.body.scrollHeight),0==f&&d(0),c(f,e-g,document.body.scrollHeight)},!1)})},workerCallback:null,worker:function(a,b){a.type?(lazy.workerCallback=b,e.postMessage({type:a.type,message:a})):v("myWorker发生数据data没有type")},openNewWin:function(a){router.cachePage[router.thisPage.path]=router.thisPage,location.href=a},"for":k,create:y,loadJs:B,loadCss:C,"typeof":l,ajax:q,setParameter:o,getParameter:p,splitUrl:m,getAutoId:function(){return"LazyAuto"+this.autoId++},bounce:function(a){router.bounceList[router.thisPage.path]=a},touchEvent:function(a){var b=this,c=b.getAutoId(),d=a&&a.dom||null;if(null!=d)return a={touchstart:a.touchstart||function(){},touchmove:a.touchmove||function(){},touchend:a.touchend||function(){}},b.touchObj[c]={},b.touchObj[c]["touchstart"]=function(b){a.touchstart({event:b,x:b.touches[0].clientX,y:b.touches[0].clientY})},b.touchObj[c]["touchmove"]=function(b){a.touchmove({event:b,x:b.touches[0].clientX,y:b.touches[0].clientY})},b.touchObj[c]["touchend"]=function(b){a.touchend({event:b,x:b.changedTouches[0].clientX,y:b.changedTouches[0].clientY})},d.addEventListener("touchstart",b.touchObj[c]["touchstart"],!1),d.addEventListener("touchmove",b.touchObj[c]["touchmove"],!1),d.addEventListener("touchend",b.touchObj[c]["touchend"],!1),{id:c,dom:d}},removeTouchEvent:function(a){var d,b=this,c=a.id;b.touchObj[c]&&(d=a.dom,d.removeEventListener("touchstart",b.touchObj[c]["touchstart"],!1),d.removeEventListener("touchmove",b.touchObj[c]["touchmove"],!1),d.removeEventListener("touchend",b.touchObj[c]["touchend"],!1),delete b.touchObj[c])},animation:function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n;if(a=parseInt(a),b=parseInt(b),g=!0,b>a)g=!0;else{if(!(a>b))return;g=!1}return i=30,j=Math.ceil(c/i),k=2*(b-a)/j-1,l=(k-1)/(j-1),"yunsu"==d?(m=Math.abs(a-b)/j,h=setInterval(function(){g?a+=m:a-=m,g&&Math.ceil(a)>=b&&(a=b,clearInterval(h),f&&f(Math.ceil(a))),!g&&Math.ceil(a)<=b&&(a=b,clearInterval(h),f&&f(Math.ceil(a))),e(Math.ceil(a))},i)):(n="jiansu"==d?k:1,h=setInterval(function(){a+=n,"jiansu"==d?n-=l:n+=l,g&&Math.ceil(a)>=b&&(a=b,clearInterval(h),f&&f(Math.ceil(a))),!g&&Math.ceil(a)<=b&&(a=b,clearInterval(h),f&&f(Math.ceil(a))),e(Math.ceil(a))},i))},clearAnimation:function(a){clearInterval(a),a=null},log:v,clearCache:g},c=function(){this.thisPage={},this.beforePage={},this.cachePage={},this.bounceList={}},c.prototype={init:function(a){var b=this;b.callback=a,window.addEventListener("load",function(){b.urlChange()}),window.addEventListener("hashchange",function(){b.urlChange()})},urlChange:function(){d&&d.postMessage({type:"clear",message:"清空线程"});var b=this;b.thisPage=m(location.hash),b.thisPage.parent=document.body,void 0==b.thisPage.path?location.hash=a.firstPage:(a.debug===!0&&g(),window.PAGE_INIT=null,b.cachePage[b.thisPage.path]&&(b.thisPage=b.cachePage[b.thisPage.path]),b.loadPage(b.thisPage,b.callback))},loadPage:function(b,c){function j(){q({url:e,type:"POST",cache:!0,data:{url:"../page/"+b.path+".js",type:"POST",filetype:"js"},success:function(a){h(a),PAGE_INIT(b),c&&c()}})}var e,f,g,d=this;d.cachePage[b.path]?(d.cachePage[b.path].dom.className="",d.cachePage[b.path].dom.style.display="block",d.removePage(d.beforePage),d.beforePage=d.cachePage[b.path],delete d.cachePage[b.path]):(d.bounceList[d.thisPage.path]=null,b.dom=y("div","#"+b.path,{type:"page"}),b.parent.appendChild(b.dom),d.anFun(b,function(){b.noRemove||(d.removePage(d.beforePage),d.beforePage=b)}),e=a.dir+"/page/"+b.path+".js",f=a.dir+"/page/"+b.path+".css",g=a.map[b.path]||{},g.css?q({url:f,type:"POST",cache:!0,data:{url:"../page/"+b.path+".css",type:"POST",filetype:"css"},success:function(a){i(a),j()},error:function(){j()}}):j())},anFun:function(b,c){function f(){c(),b.dom.removeEventListener("webkitAnimationEnd",f,!1)}var e=a.map[b.path]||{};if(e.animate){switch(e.animate){case 0:b.dom.className="pageTopToBottom";break;case 1:b.dom.className="pageRightToLeft";break;case 2:b.dom.className="pageBottomToTop";break;case 3:b.dom.className="pageLeftToRight"}b.dom.addEventListener("webkitAnimationEnd",f,!1)}else c()},removePage:function(a){var d,e,b=this;if(b.cachePage[a.path])b.cachePage[a.path].dom.style.display="none";else if(a.parent&&a.dom){for(a.path,d=a.dom.querySelectorAll("[type]"),e=0;e<d.length;e++)d[e].removeAttribute("id");a.parent.removeChild(a.dom)}}},d=null,e=null,window.start=function(f,g){d=new Worker(a.dir+"/admin/worker.js"),d.postMessage({type:"string",message:"启动线程"}),d.onmessage=function(a){var b=a.data;switch(b.type){case"ajaxList":s(b);break;case"log":w(b.message)}},e=new Worker(a.dir+"/admin/myWorker.js"),e.postMessage({type:"string",message:"启动计算线程"}),e.onmessage=function(a){var b=a.data;switch(b.type){case"calculator":lazy.workerCallback(b.message);break;case"log":x(b.message)}},g&&k(g,function(b,c){a[c]=b}),j(),window.router=new c,window.lazy=new b,lazy.browserType=a.browserType,router.init(function(){1!=lazy.thisLoad&&lazy.init(function(){lazy.thisLoad=!0,f()})})},window.setData=function(a,b){var c,d;switch(l(a)){case"array":if(c=router.thisPage.dom,0==a.length)return callBack(el,a),void 0;d=0,!function e(){z(a[d],function(f){d<a.length-1?(d++,e()):b&&b(f,a,c)},c)}();break;case"object":z(a,function(c){b&&b(c,a)});break;default:v("setData格式不对!")}},window.getData=function(a){return lazy.pluginsId[a]}}();